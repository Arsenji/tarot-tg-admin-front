#!/bin/bash

echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –Æ–∫–∞—Å—Å—ã"
echo "========================================"

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
check_status() {
    if [ $1 -eq 0 ]; then
        echo -e "${GREEN}‚úÖ $2${NC}"
    else
        echo -e "${RED}‚ùå $2${NC}"
    fi
}

echo -e "${BLUE}üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:${NC}"
echo "1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –Æ–∫–∞—Å—Å—ã"
echo "2. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞: @tarolog_app_bot"
echo "3. –í—ã–±–µ—Ä–∏—Ç–µ '–ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É'"
echo "4. –í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π —Ç–∞—Ä–∏—Ñ"
echo "5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É: 5555 5555 5555 4444"
echo "6. –°—Ä–æ–∫: –ª—é–±–∞—è –±—É–¥—É—â–∞—è –¥–∞—Ç–∞, CVC: –ª—é–±—ã–µ 3 —Ü–∏—Ñ—Ä—ã"
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –±—ç–∫–µ–Ω–¥–∞..."
curl -s http://localhost:3001/api/health > /dev/null
check_status $? "–ë—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Æ–∫–∞—Å—Å—ã
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Æ–∫–∞—Å—Å—ã..."
YOOKASSA_SHOP_ID=$(grep "YOOKASSA_SHOP_ID" .env | cut -d'=' -f2)
YOOKASSA_SECRET_KEY=$(grep "YOOKASSA_SECRET_KEY" .env | cut -d'=' -f2)

if [ "$YOOKASSA_SHOP_ID" = "test_shop_id" ] || [ "$YOOKASSA_SECRET_KEY" = "test_secret_key" ]; then
    echo -e "${YELLOW}‚ö†Ô∏è  –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –Æ–∫–∞—Å—Å—ã${NC}"
    echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ ./update-yookassa.sh –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
else
    echo -e "${GREEN}‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Æ–∫–∞—Å—Å—ã${NC}"
fi

echo ""
echo -e "${BLUE}üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã:${NC}"
echo "‚Ä¢ –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 5555 5555 5555 4444"
echo "‚Ä¢ –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 5555 5555 5555 4477"
echo "‚Ä¢ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: 5555 5555 5555 4455"
echo ""
echo -e "${BLUE}üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–æ—Ç–µ:${NC}"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ @tarolog_app_bot"
echo "2. –í—ã–±–µ—Ä–∏—Ç–µ '–ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É'"
echo "3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ"
echo "4. –û–ø–ª–∞—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π"
echo "5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–æ–¥–ø–∏—Å–∫–∏"
echo ""
echo -e "${BLUE}üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:${NC}"
echo "‚Ä¢ –õ–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞: tail -f logs/app.log"
echo "‚Ä¢ –°—Ç–∞—Ç—É—Å webhook: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –Æ–∫–∞—Å—Å—ã"
echo "‚Ä¢ –¢–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"
