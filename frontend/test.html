<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –¢–∞—Ä–æ API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }
        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .result {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .card-image {
            width: 200px;
            height: 300px;
            object-fit: cover;
            border-radius: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üé¥ –¢–µ—Å—Ç –¢–∞—Ä–æ API</h1>
    
    <div class="card">
        <h2>–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
        <button onclick="authenticate()">–í–æ–π—Ç–∏ –∫–∞–∫ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</button>
        <div id="auth-result" class="result"></div>
    </div>

    <div class="card">
        <h2>–ì–∞–¥–∞–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–∞—Ö</h2>
        <button onclick="getSingleCard()">–í—ã—Ç—è–Ω—É—Ç—å –æ–¥–Ω—É –∫–∞—Ä—Ç—É</button>
        <button onclick="getThreeCards()">–í—ã—Ç—è–Ω—É—Ç—å —Ç—Ä–∏ –∫–∞—Ä—Ç—ã</button>
        <button onclick="getYesNoCard()">–î–∞/–ù–µ—Ç –≥–∞–¥–∞–Ω–∏–µ</button>
        <div id="card-result" class="result"></div>
    </div>

    <script>
        let token = null;

        async function authenticate() {
            const resultDiv = document.getElementById('auth-result');
            resultDiv.innerHTML = '–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è...';
            
            try {
                const testUserData = {
                    id: 123456789,
                    first_name: 'Test',
                    last_name: 'User',
                    username: 'testuser',
                    language_code: 'ru'
                };
                
                const testInitData = `user=${encodeURIComponent(JSON.stringify(testUserData))}&auth_date=${Math.floor(Date.now() / 1000)}&hash=test_hash`;
                
                const response = await fetch('http://localhost:3001/api/auth/telegram', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ initData: testInitData })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    token = data.token;
                    resultDiv.innerHTML = `
                        <h3>‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!</h3>
                        <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> ${data.user.firstName} ${data.user.lastName}</p>
                        <p><strong>Telegram ID:</strong> ${data.user.telegramId}</p>
                        <p><strong>–ü—Ä–µ–º–∏—É–º:</strong> ${data.user.isPremium ? '–î–∞' : '–ù–µ—Ç'}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:</h3><p>${data.error}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏:</h3><p>${error.message}</p>`;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –∫–∞—Ä—Ç—ã –∏–∑ –ø–∞–ø–∫–∏ rider-waite
        function getRiderWaiteImagePath(cardName) {
            const cardImageMap = {
                // –°—Ç–∞—Ä—à–∏–µ –∞—Ä–∫–∞–Ω—ã
                '–®—É—Ç': 'major_arcana_fool.png',
                '–ú–∞–≥': 'major_arcana_magician.png',
                '–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞': 'major_arcana_priestess.png',
                '–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞': 'major_arcana_empress.png',
                '–ò–º–ø–µ—Ä–∞—Ç–æ—Ä': 'major_arcana_emperor.png',
                '–ò–µ—Ä–æ—Ñ–∞–Ω—Ç': 'major_arcana_hierophant.png',
                '–í–ª—é–±–ª–µ–Ω–Ω—ã–µ': 'major_arcana_lovers.png',
                '–ö–æ–ª–µ—Å–Ω–∏—Ü–∞': 'major_arcana_chariot.png',
                '–°–∏–ª–∞': 'major_arcana_strength.png',
                '–û—Ç—à–µ–ª—å–Ω–∏–∫': 'major_arcana_hermit.png',
                '–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã': 'major_arcana_fortune.png',
                '–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å': 'major_arcana_justice.png',
                '–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π': 'major_arcana_hanged.png',
                '–°–º–µ—Ä—Ç—å': 'major_arcana_death.png',
                '–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å': 'major_arcana_temperance.png',
                '–î—å—è–≤–æ–ª': 'major_arcana_devil.png',
                '–ë–∞—à–Ω—è': 'major_arcana_tower.png',
                '–ó–≤–µ–∑–¥–∞': 'major_arcana_star.png',
                '–õ—É–Ω–∞': 'major_arcana_moon.png',
                '–°–æ–ª–Ω—Ü–µ': 'major_arcana_sun.png',
                '–°—É–¥': 'major_arcana_judgement.png',
                '–ú–∏—Ä': 'major_arcana_world.png',
                
                // –ú–ª–∞–¥—à–∏–µ –∞—Ä–∫–∞–Ω—ã - –ñ–µ–∑–ª—ã
                '–¢—É–∑ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_ace.png',
                '–î–≤–æ–π–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_2.png',
                '–¢—Ä–æ–π–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_3.png',
                '–ß–µ—Ç–≤–µ—Ä–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_4.png',
                '–ü—è—Ç–µ—Ä–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_5.png',
                '–®–µ—Å—Ç–µ—Ä–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_6.png',
                '–°–µ–º–µ—Ä–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_7.png',
                '–í–æ—Å—å–º–µ—Ä–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_8.png',
                '–î–µ–≤—è—Ç–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_9.png',
                '–î–µ—Å—è—Ç–∫–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_10.png',
                '–ü–∞–∂ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_page.png',
                '–†—ã—Ü–∞—Ä—å –ñ–µ–∑–ª—ã': 'minor_arcana_wands_knight.png',
                '–ö–æ—Ä–æ–ª–µ–≤–∞ –ñ–µ–∑–ª—ã': 'minor_arcana_wands_queen.png',
                '–ö–æ—Ä–æ–ª—å –ñ–µ–∑–ª—ã': 'minor_arcana_wands_king.png',
                
                // –ú–ª–∞–¥—à–∏–µ –∞—Ä–∫–∞–Ω—ã - –ö—É–±–∫–∏
                '–¢—É–∑ –ö—É–±–∫–∏': 'minor_arcana_cups_ace.png',
                '–î–≤–æ–π–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_2.png',
                '–¢—Ä–æ–π–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_3.png',
                '–ß–µ—Ç–≤–µ—Ä–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_4.png',
                '–ü—è—Ç–µ—Ä–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_5.png',
                '–®–µ—Å—Ç–µ—Ä–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_6.png',
                '–°–µ–º–µ—Ä–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_7.png',
                '–í–æ—Å—å–º–µ—Ä–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_8.png',
                '–î–µ–≤—è—Ç–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_9.png',
                '–î–µ—Å—è—Ç–∫–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_10.png',
                '–ü–∞–∂ –ö—É–±–∫–∏': 'minor_arcana_cups_page.png',
                '–†—ã—Ü–∞—Ä—å –ö—É–±–∫–∏': 'minor_arcana_cups_knight.png',
                '–ö–æ—Ä–æ–ª–µ–≤–∞ –ö—É–±–∫–∏': 'minor_arcana_cups_queen.png',
                '–ö–æ—Ä–æ–ª—å –ö—É–±–∫–∏': 'minor_arcana_cups_king.png',
                
                // –ú–ª–∞–¥—à–∏–µ –∞—Ä–∫–∞–Ω—ã - –ú–µ—á–∏
                '–¢—É–∑ –ú–µ—á–∏': 'minor_arcana_swords_ace.png',
                '–î–≤–æ–π–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_2.png',
                '–¢—Ä–æ–π–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_3.png',
                '–ß–µ—Ç–≤–µ—Ä–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_4.png',
                '–ü—è—Ç–µ—Ä–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_5.png',
                '–®–µ—Å—Ç–µ—Ä–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_6.png',
                '–°–µ–º–µ—Ä–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_7.png',
                '–í–æ—Å—å–º–µ—Ä–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_8.png',
                '–î–µ–≤—è—Ç–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_9.png',
                '–î–µ—Å—è—Ç–∫–∞ –ú–µ—á–∏': 'minor_arcana_swords_10.png',
                '–ü–∞–∂ –ú–µ—á–∏': 'minor_arcana_swords_page.png',
                '–†—ã—Ü–∞—Ä—å –ú–µ—á–∏': 'minor_arcana_swords_knight.png',
                '–ö–æ—Ä–æ–ª–µ–≤–∞ –ú–µ—á–∏': 'minor_arcana_swords_queen.png',
                '–ö–æ—Ä–æ–ª—å –ú–µ—á–∏': 'minor_arcana_swords_king.png',
                
                // –ú–ª–∞–¥—à–∏–µ –∞—Ä–∫–∞–Ω—ã - –ü–µ–Ω—Ç–∞–∫–ª–∏
                '–¢—É–∑ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_ace.png',
                '–î–≤–æ–π–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_2.png',
                '–¢—Ä–æ–π–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_3.png',
                '–ß–µ—Ç–≤–µ—Ä–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_4.png',
                '–ü—è—Ç–µ—Ä–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_5.png',
                '–®–µ—Å—Ç–µ—Ä–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_6.png',
                '–°–µ–º–µ—Ä–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_7.png',
                '–í–æ—Å—å–º–µ—Ä–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_8.png',
                '–î–µ–≤—è—Ç–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_9.png',
                '–î–µ—Å—è—Ç–∫–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_10.png',
                '–ü–∞–∂ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_page.png',
                '–†—ã—Ü–∞—Ä—å –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_knight.png',
                '–ö–æ—Ä–æ–ª–µ–≤–∞ –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_queen.png',
                '–ö–æ—Ä–æ–ª—å –ü–µ–Ω—Ç–∞–∫–ª–∏': 'minor_arcana_pentacles_king.png',
            };

            const fileName = cardImageMap[cardName];
            if (fileName) {
                return `http://localhost:3000/images/rider-waite-tarot/${fileName}`;
            }
            
            // –ï—Å–ª–∏ –∫–∞—Ä—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–∞–≥–ª—É—à–∫—É
            console.warn(`–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç—ã "${cardName}" –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`);
            return 'http://localhost:3000/images/rider-waite-tarot/major_arcana_fool.png';
        }

        async function getSingleCard() {
            if (!token) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é!');
                return;
            }
            
            const resultDiv = document.getElementById('card-result');
            resultDiv.innerHTML = '–í—ã—Ç—è–≥–∏–≤–∞–µ–º –∫–∞—Ä—Ç—É...';
            
            try {
                const response = await fetch('http://localhost:3001/api/tarot/single-card', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({})
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    const card = data.card;
                    const riderWaiteImagePath = getRiderWaiteImagePath(card.name);
                    
                    resultDiv.innerHTML = `
                        <h3>üé¥ ${card.name}</h3>
                        <img src="${riderWaiteImagePath}" alt="${card.name}" class="card-image" onerror="this.style.display='none'">
                        <p><strong>–ó–Ω–∞—á–µ–Ω–∏–µ:</strong> ${card.meaning}</p>
                        <p><strong>–°–æ–≤–µ—Ç:</strong> ${card.advice}</p>
                        <p><strong>–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:</strong> ${card.keywords}</p>
                        <p><strong>–¢–æ–ª–∫–æ–≤–∞–Ω–∏–µ:</strong> ${data.interpretation}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞:</h3><p>${data.error}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏:</h3><p>${error.message}</p>`;
            }
        }

        async function getThreeCards() {
            if (!token) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é!');
                return;
            }
            
            const resultDiv = document.getElementById('card-result');
            resultDiv.innerHTML = '–í—ã—Ç—è–≥–∏–≤–∞–µ–º —Ç—Ä–∏ –∫–∞—Ä—Ç—ã...';
            
            try {
                const response = await fetch('http://localhost:3001/api/tarot/three-cards', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ category: 'personal' })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    let cardsHtml = '<h3>üé¥ –†–∞—Å–∫–ª–∞–¥ —Ç—Ä–µ—Ö –∫–∞—Ä—Ç</h3>';
                    const positions = ['–ü—Ä–æ—à–ª–æ–µ', '–ù–∞—Å—Ç–æ—è—â–µ–µ', '–ë—É–¥—É—â–µ–µ'];
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç—ã
                    for (let i = 0; i < data.cards.length; i++) {
                        const card = data.cards[i];
                        const position = positions[i];
                        
                        try {
                            const meaningResponse = await fetch(`http://localhost:3000/tarot_meanings_pro/${card.name}.json`);
                            let detailedMeaning = null;
                            if (meaningResponse.ok) {
                                detailedMeaning = await meaningResponse.json();
                            }
                            
                            const riderWaiteImagePath = getRiderWaiteImagePath(card.name);
                            
                            cardsHtml += `
                                <div style="margin: 20px 0; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px; border: 1px solid rgba(255,255,255,0.2);">
                                    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                                        <img src="${riderWaiteImagePath}" alt="${card.name}" style="width: 120px; height: 180px; object-fit: cover; border-radius: 8px;" onerror="this.style.display='none'">
                                        <div style="flex: 1;">
                                            <h4 style="color: #fbbf24; margin: 0 0 5px 0;">${position}: ${card.name}</h4>
                                            <p style="margin: 0 0 10px 0; color: #e5e7eb;"><strong>–ó–Ω–∞—á–µ–Ω–∏–µ:</strong> ${card.meaning}</p>
                                            <p style="margin: 0; color: #e5e7eb;"><strong>–°–æ–≤–µ—Ç:</strong> ${card.advice}</p>
                                        </div>
                                    </div>
                                    ${detailedMeaning ? `
                                        <div style="background: rgba(255,255,255,0.05); border-radius: 10px; padding: 15px;">
                                            <h5 style="color: #f59e0b; margin: 0 0 10px 0;">üìñ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è:</h5>
                                            <div style="display: grid; gap: 10px;">
                                                <div><strong style="color: #ec4899;">üíï –õ—é–±–æ–≤—å:</strong> <span style="color: #d1d5db;">${detailedMeaning.love}</span></div>
                                                <div><strong style="color: #3b82f6;">üíº –ö–∞—Ä—å–µ—Ä–∞:</strong> <span style="color: #d1d5db;">${detailedMeaning.career}</span></div>
                                                <div><strong style="color: #8b5cf6;">‚ú® –õ–∏—á–Ω–æ–µ:</strong> <span style="color: #d1d5db;">${detailedMeaning.personal}</span></div>
                                            </div>
                                        </div>
                                    ` : ''}
                                </div>
                            `;
                        } catch (error) {
                            console.warn(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è ${card.name}:`, error);
                            const riderWaiteImagePath = getRiderWaiteImagePath(card.name);
                            cardsHtml += `
                                <div style="margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                                    <h4>${position}: ${card.name}</h4>
                                    <img src="${riderWaiteImagePath}" alt="${card.name}" style="width: 150px; height: 225px; object-fit: cover; border-radius: 8px; margin: 10px 0;" onerror="this.style.display='none'">
                                    <p><strong>–ó–Ω–∞—á–µ–Ω–∏–µ:</strong> ${card.meaning}</p>
                                    <p><strong>–°–æ–≤–µ—Ç:</strong> ${card.advice}</p>
                                </div>
                            `;
                        }
                    }
                    
                    cardsHtml += `<p style="margin-top: 20px; padding: 15px; background: rgba(59, 130, 246, 0.1); border-radius: 10px; border: 1px solid rgba(59, 130, 246, 0.3);"><strong style="color: #3b82f6;">üîÆ –û–±—â–µ–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–µ:</strong> <span style="color: #d1d5db;">${data.interpretation}</span></p>`;
                    resultDiv.innerHTML = cardsHtml;
                } else {
                    resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞:</h3><p>${data.error}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏:</h3><p>${error.message}</p>`;
            }
        }

        async function getYesNoCard() {
            if (!token) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é!');
                return;
            }
            
            const resultDiv = document.getElementById('card-result');
            resultDiv.innerHTML = '–í—ã—Ç—è–≥–∏–≤–∞–µ–º –∫–∞—Ä—Ç—É –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –î–∞/–ù–µ—Ç...';
            
            try {
                const response = await fetch('http://localhost:3001/api/tarot/single-card', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({})
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    const card = data.card;
                    const riderWaiteImagePath = getRiderWaiteImagePath(card.name);
                    const isYes = card.number % 2 === 0;
                    
                    resultDiv.innerHTML = `
                        <h3>‚ùì –û—Ç–≤–µ—Ç –î–∞/–ù–µ—Ç</h3>
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="display: inline-flex; align-items: center; justify-content: center; width: 80px; height: 80px; border-radius: 50%; background: ${isYes ? '#10b981' : '#ef4444'}; margin-bottom: 20px;">
                                <span style="font-size: 24px; font-weight: bold; color: white;">${isYes ? '‚úì' : '‚úó'}</span>
                            </div>
                            <h2 style="color: ${isYes ? '#10b981' : '#ef4444'}; font-size: 48px; margin: 0;">${isYes ? '–î–ê' : '–ù–ï–¢'}</h2>
                            <p style="color: #9ca3af; margin-top: 10px;">–û—Ç–≤–µ—Ç –Ω–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å</p>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px; margin: 20px 0;">
                            <div style="text-align: center;">
                                <img src="${riderWaiteImagePath}" alt="${card.name}" style="width: 150px; height: 225px; object-fit: cover; border-radius: 8px; margin-bottom: 15px;" onerror="this.style.display='none'">
                                <h4 style="color: #fbbf24; margin: 0 0 10px 0;">${card.name}</h4>
                                <p style="margin: 0; color: #e5e7eb;"><strong>–ó–Ω–∞—á–µ–Ω–∏–µ:</strong> ${card.meaning}</p>
                                <p style="margin: 10px 0 0 0; color: #e5e7eb;"><strong>–°–æ–≤–µ—Ç:</strong> ${card.advice}</p>
                            </div>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞:</h3><p>${data.error}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<h3>‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏:</h3><p>${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
